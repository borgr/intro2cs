import datetime
from geo import Position
from string import ascii_letters
from data import load_sentiments
import itertools as it

tweetlist = [["Can't wait to get the ballers going. If I can do half of what Gary Rankin has done I will be happy. The time is now. Chess not checkers.", datetime.datetime(2011, 8, 28, 21, 53, 4), 35.88101863, -84.12181997, ['can', 't', 'wait', 'to', 'get', 'the', 'ballers', 'going', 'if', 'i', 'can', 'do', 'half', 'of', 'what', 'gary', 'rankin', 'has', 'done', 'i', 'will', 'be', 'happy', 'the', 'time', 'is', 'now', 'chess', 'not', 'checkers'], -0.25],
             ['I love playing chess secret society get it...', datetime.datetime(2011, 8, 28, 21, 59, 6), 40.73608366, -73.88225612, ['i', 'love', 'playing', 'chess', 'secret', 'society', 'get', 'it'], 0.041666666666666664],
             ['Arena sized chess in Westlake Park. http://t.co/fChffds', datetime.datetime(2011, 8, 28, 22, 13, 56), 47.61048985, -122.33720303, ['arena', 'sized', 'chess', 'in', 'westlake', 'park', 'http', 't', 'co', 'fchffds'], None],
             ['A Correspondence Chess Win By Resignation http://t.co/kN0SEDw', datetime.datetime(2011, 8, 29, 14, 58, 32), 29.424222, -98.493196, ['a', 'correspondence', 'chess', 'win', 'by', 'resignation', 'http', 't', 'co', 'kn', 'sedw'], None],
             ['Life is a game of chess with no cleavage', datetime.datetime(2011, 8, 29, 15, 26, 2), 30.40810281, -84.28319438, ['life', 'is', 'a', 'game', 'of', 'chess', 'with', 'no', 'cleavage'], -0.375],
             ['Chess and heuristics. The deeper the search, the better the computer plays', datetime.datetime(2011, 8, 29, 17, 46, 22), 40.73021739, -73.98686309, ['chess', 'and', 'heuristics', 'the', 'deeper', 'the', 'search', 'the', 'better', 'the', 'computer', 'plays'], 0.875],
             ['We all agree -- @Martindillon would love this.   @ Chess and Checkers House http://t.co/p1vPsQU', datetime.datetime(2011, 8, 29, 21, 11, 10), 40.76900427, -73.97480965, ['we', 'all', 'agree', 'martindillon', 'would', 'love', 'this', 'chess', 'and', 'checkers', 'house', 'http', 't', 'co', 'p', 'vpsqu'], 0.5625],
             ["Chess with friends is where it's at.", datetime.datetime(2011, 8, 30, 1, 31, 2), 37.16132952, -76.51713034, ['chess', 'with', 'friends', 'is', 'where', 'it', 's', 'at'], None],
             ['If I get more bored, I might decide to take up chess.', datetime.datetime(2011, 8, 30, 3, 4, 40), 44.18803828, -79.93544197, ['if', 'i', 'get', 'more', 'bored', 'i', 'might', 'decide', 'to', 'take', 'up', 'chess'], -0.25],
             ['I hate chess I never win', datetime.datetime(2011, 8, 30, 3, 43, 13), 43.1896701, -77.5615805, ['i', 'hate', 'chess', 'i', 'never', 'win'], -0.34375],
             ['Sinclair loses at chess every 20sec and it makes a BEWWW sound every time. I love fake tv video games.', datetime.datetime(2011, 8, 30, 4, 3, 55), 47.6675083, -122.3767418, ['sinclair', 'loses', 'at', 'chess', 'every', 'sec', 'and', 'it', 'makes', 'a', 'bewww', 'sound', 'every', 'time', 'i', 'love', 'fake', 'tv', 'video', 'games'], 0.0],
             ['its like a game of chess... check and mate.', datetime.datetime(2011, 8, 30, 4, 19, 49), 33.87020417, -118.15500751, ['its', 'like', 'a', 'game', 'of', 'chess', 'check', 'and', 'mate'], -0.08333333333333333],
             ['Lifes like a chess move, make your next move', datetime.datetime(2011, 8, 30, 5, 27, 21), 41.72347118, -71.46565332, ['lifes', 'like', 'a', 'chess', 'move', 'make', 'your', 'next', 'move'], 0.125],
             ['@MarquesaCaro web us no chess misis marquesa', datetime.datetime(2011, 8, 30, 7, 13, 52), 20.71473678, -100.45354163, ['marquesacaro', 'web', 'us', 'no', 'chess', 'misis', 'marquesa'], 0.0],
             ['Every man needs a women when his life is a mess because the QUEEN protects the king , like a game of chess. #MrJuug #KingShit', datetime.datetime(2011, 8, 28, 23, 11, 8), 35.8481425, -78.6065005, ['every', 'man', 'needs', 'a', 'women', 'when', 'his', 'life', 'is', 'a', 'mess', 'because', 'the', 'queen', 'protects', 'the', 'king', 'like', 'a', 'game', 'of', 'chess', 'mrjuug', 'kingshit'], -0.16666666666666666],
             ['@DaZackTesolin CHESS !', datetime.datetime(2011, 8, 30, 14, 20, 26), 42.25032829, -83.01735778, ['dazacktesolin', 'chess'], None],
             ['Contact Chess - Martial Art of Mind. Anatomy of a Fight http://t.co/4neasaN', datetime.datetime(2011, 8, 30, 16, 42, 12), 33.952602, -84.549933, ['contact', 'chess', 'martial', 'art', 'of', 'mind', 'anatomy', 'of', 'a', 'fight', 'http', 't', 'co', 'neasan'], -0.0625],
             ['I wish I can win in chess.', datetime.datetime(2011, 8, 31, 3, 10, 56), 40.9275493, -74.0041221, ['i', 'wish', 'i', 'can', 'win', 'in', 'chess'], 0.0],
             ['This is a game of chess', datetime.datetime(2011, 8, 31, 7, 7, 19), 32.79806793, -96.69127464, ['this', 'is', 'a', 'game', 'of', 'chess'], -0.5],
             ['Life is really a game of chess', datetime.datetime(2011, 8, 31, 9, 57, 12), 39.9719747, -75.2022334, ['life', 'is', 'really', 'a', 'game', 'of', 'chess'], 0.0625],
             ['Organized all my apps into folders in Launchpad. Realized I have all of two games on my Mac: Chess and Hordes of Orcs.', datetime.datetime(2011, 8, 31, 13, 30, 23), 33.98603179, -81.02913662, ['organized', 'all', 'my', 'apps', 'into', 'folders', 'in', 'launchpad', 'realized', 'i', 'have', 'all', 'of', 'two', 'games', 'on', 'my', 'mac', 'chess', 'and', 'hordes', 'of', 'orcs'], 0.25],
             ['make your next move your best move chess not checkers', datetime.datetime(2011, 8, 31, 18, 29, 40), 29.84602948, -95.42305242, ['make', 'your', 'next', 'move', 'your', 'best', 'move', 'chess', 'not', 'checkers'], 0.20833333333333334],
             ['@CW_baybee nah Im in, I gotta get up early 2moro and no I was playin chess', datetime.datetime(2011, 9, 1, 3, 25, 21), 32.2988318, -90.2035996, ['cw', 'baybee', 'nah', 'im', 'in', 'i', 'gotta', 'get', 'up', 'early', 'moro', 'and', 'no', 'i', 'was', 'playin', 'chess'], -0.25],
             ['I NEED TO PLAY  #chess WITH SOMEONE  !', datetime.datetime(2011, 9, 1, 4, 26, 27), 40.748197, -74.239215, ['i', 'need', 'to', 'play', 'chess', 'with', 'someone'], -0.25],
             ["I'm at Willie Dixon's Blues Heaven Foundation (Historic Site of Chess Records) (2120 S. Michigan Ave., Chicago) http://t.co/y9PA5Yi", datetime.datetime(2011, 9, 1, 4, 42, 35), 41.853589, -87.624231, ['i', 'm', 'at', 'willie', 'dixon', 's', 'blues', 'heaven', 'foundation', 'historic', 'site', 'of', 'chess', 'records', 's', 'michigan', 'ave', 'chicago', 'http', 't', 'co', 'y', 'pa', 'yi'], -0.25],
             ['Missing alll da bet chess @izbrittanybetch @blbolton11 @Caweeener @kriztoefor @BHOLTZ8 @roma_desai @gsemz', datetime.datetime(2011, 9, 1, 5, 13, 52), 40.95712697, -76.8840182, ['missing', 'alll', 'da', 'bet', 'chess', 'izbrittanybetch', 'blbolton', 'caweeener', 'kriztoefor', 'bholtz', 'roma', 'desai', 'gsemz'], -0.5],
             ['Trying to bang this dude is like playing a chess game. I just want Belgium waffles.', datetime.datetime(2011, 9, 1, 5, 23, 59), 30.26968628, -97.74949126, ['trying', 'to', 'bang', 'this', 'dude', 'is', 'like', 'playing', 'a', 'chess', 'game', 'i', 'just', 'want', 'belgium', 'waffles'], -0.08928571428571429],
             ['Up playing chess #IAmTheBest', datetime.datetime(2011, 9, 1, 6, 42, 56), 33.72647953, -116.96683979, ['up', 'playing', 'chess', 'iamthebest'], None],
             ['"@CarmenMaree: When u stop believing in me it doesn\'t discourage me it encourages me. Chess not checkers"&gt;no chess only checkers king me lol', datetime.datetime(2011, 9, 1, 7, 30, 26), 37.3508968, -121.9155979, ['carmenmaree', 'when', 'u', 'stop', 'believing', 'in', 'me', 'it', 'doesn', 't', 'discourage', 'me', 'it', 'encourages', 'me', 'chess', 'not', 'checkers', 'gt', 'no', 'chess', 'only', 'checkers', 'king', 'me', 'lol'], -0.4375],
             ['Cabdrivers playing chess on Lankershim http://t.co/VKmMBr1', datetime.datetime(2011, 9, 1, 10, 37, 35), 34.16588, -118.363726, ['cabdrivers', 'playing', 'chess', 'on', 'lankershim', 'http', 't', 'co', 'vkmmbr'], None],
             ['Chess really can make hisself sound like he from New Orleans.', datetime.datetime(2011, 9, 1, 16, 42, 16), 32.29965037, -90.21041482, ['chess', 'really', 'can', 'make', 'hisself', 'sound', 'like', 'he', 'from', 'new', 'orleans'], 0.4],
             ['Playing chess....sit back and watch', datetime.datetime(2011, 9, 1, 18, 10, 16), 29.99374808, -95.48194177, ['playing', 'chess', 'sit', 'back', 'and', 'watch'], 0.375],
             ['I feel like a pilgrim playing chess on my laptop.', datetime.datetime(2011, 8, 29, 1, 39, 45), 42.2434638, -71.8070041, ['i', 'feel', 'like', 'a', 'pilgrim', 'playing', 'chess', 'on', 'my', 'laptop'], -0.25],
             ['Playing chess with @teachu2swag91 #intelligenceiskey', datetime.datetime(2011, 9, 1, 20, 31, 17), 39.19055013, -96.58069392, ['playing', 'chess', 'with', 'teachu', 'swag', 'intelligenceiskey'], None],
             ["Kept pieces in great shape; never wanted to play them. RT @amhistorymuseum: Gen. McClellan's chess set: http://t.co/aNqMiN9 #CivilWar", datetime.datetime(2011, 9, 1, 22, 5, 7), 35.54968891, -79.19119128, ['kept', 'pieces', 'in', 'great', 'shape', 'never', 'wanted', 'to', 'play', 'them', 'rt', 'amhistorymuseum', 'gen', 'mcclellan', 's', 'chess', 'set', 'http', 't', 'co', 'anqmin', 'civilwar'], -0.03125],
             ['Good games of chess to have a que (@ Woodruff Park Chess Court) [pic]: http://t.co/1J38OHb', datetime.datetime(2011, 9, 1, 22, 30, 53), 33.75497282, -84.38881874, ['good', 'games', 'of', 'chess', 'to', 'have', 'a', 'que', 'woodruff', 'park', 'chess', 'court', 'pic', 'http', 't', 'co', 'j', 'ohb'], 0.4583333333333333],
             ['Love is like chess: one false move and your mated!', datetime.datetime(2011, 9, 2, 12, 18, 8), 39.67314645, -75.5933131, ['love', 'is', 'like', 'chess', 'one', 'false', 'move', 'and', 'your', 'mated'], -0.075],
             ['Life is like chess watch out for the thiefs...', datetime.datetime(2011, 8, 29, 2, 15, 9), 40.73606891, -73.8822584, ['life', 'is', 'like', 'chess', 'watch', 'out', 'for', 'the', 'thiefs'], -0.5],
             ["I've been really good busy with chess games...", datetime.datetime(2011, 8, 29, 2, 41, 54), 40.73605699, -73.88223831, ['i', 've', 'been', 'really', 'good', 'busy', 'with', 'chess', 'games'], 0.40625],
             ['I kind of miss playing chess!', datetime.datetime(2011, 8, 29, 3, 57, 29), 25.846725, -80.2089483, ['i', 'kind', 'of', 'miss', 'playing', 'chess'], 0.041666666666666664],
             ['This A Game Of Chess You Niggas Think Its Clevage Smh', datetime.datetime(2011, 8, 29, 5, 19, 44), 41.889577, -87.7166733, ['this', 'a', 'game', 'of', 'chess', 'you', 'niggas', 'think', 'its', 'clevage', 'smh'], -0.5],
             ['I got chess pains', datetime.datetime(2011, 8, 29, 7, 21, 52), 40.59106637, -73.95400384, ['i', 'got', 'chess', 'pains'], -0.25],
             ["@MickeyFactz yo what up with the All City Chess Club man? I need a mixtape from y'all BADLY!", datetime.datetime(2011, 9, 2, 15, 57, 43), 40.8890272, -73.86439015, ['mickeyfactz', 'yo', 'what', 'up', 'with', 'the', 'all', 'city', 'chess', 'club', 'man', 'i', 'need', 'a', 'mixtape', 'from', 'y', 'all', 'badly'], 0.125],
             ["checkmate RT @MarkusAMaximus: @AssHoleGabe I didn't know you were into chess.", datetime.datetime(2011, 9, 8, 17, 17, 59), 32.60908591, -114.70923197, ['checkmate', 'rt', 'markusamaximus', 'assholegabe', 'i', 'didn', 't', 'know', 'you', 'were', 'into', 'chess'], 0.2916666666666667],
             ['@booda0329 lol yeah he deserves to get his chess caved in 2day', datetime.datetime(2011, 9, 8, 18, 17, 21), 39.74443149, -75.52001935, ['booda', 'lol', 'yeah', 'he', 'deserves', 'to', 'get', 'his', 'chess', 'caved', 'in', 'day'], None],
             ["I'm at Panda Express (2011 Chess Dr., Bridgepointe Pkwy., San Mateo) http://t.co/ptyARBn", datetime.datetime(2011, 9, 8, 18, 38, 57), 37.562765, -122.280813, ['i', 'm', 'at', 'panda', 'express', 'chess', 'dr', 'bridgepointe', 'pkwy', 'san', 'mateo', 'http', 't', 'co', 'ptyarbn'], -0.375],
             ["@Eminem @ItsBadMeetsEvil Can't tell the difference.preference is on the challenge. Chess is a game of quiet minds.", datetime.datetime(2011, 9, 8, 19, 0, 19), 28.00071117, -82.54994606, ['eminem', 'itsbadmeetsevil', 'can', 't', 'tell', 'the', 'difference', 'preference', 'is', 'on', 'the', 'challenge', 'chess', 'is', 'a', 'game', 'of', 'quiet', 'minds'], -0.25],
             ['@XSTROLOGY: #Cancer women R the best players of romantic chess. She knw exactly hw to make a man desperately fall in love with her. THATS ME', datetime.datetime(2011, 9, 8, 21, 55, 11), 35.013108, -90.058008, ['xstrology', 'cancer', 'women', 'r', 'the', 'best', 'players', 'of', 'romantic', 'chess', 'she', 'knw', 'exactly', 'hw', 'to', 'make', 'a', 'man', 'desperately', 'fall', 'in', 'love', 'with', 'her', 'thats', 'me'], 0.53125],
             ['These n*ggas in here playing chess! Instead of cuttin hair \ue416', datetime.datetime(2011, 9, 8, 22, 16, 10), 33.21861974, -97.12732133, ['these', 'n', 'ggas', 'in', 'here', 'playing', 'chess', 'instead', 'of', 'cuttin', 'hair'], None],
             ['Мы с Катей Лагно:))  @ World Chess Hall of Fame http://t.co/EvL1cLA', datetime.datetime(2011, 9, 9, 0, 21, 29), 38.644756, -90.261281, ['world', 'chess', 'hall', 'of', 'fame', 'http', 't', 'co', 'evl', 'cla'], -0.375],
             ['Только что открыли Музей Шахматной Славы:) (@ World Chess Hall of Fame w/ 4 others) [pic]: http://t.co/kLfMIga', datetime.datetime(2011, 9, 9, 0, 26, 25), 38.644756, -90.261281, ['world', 'chess', 'hall', 'of', 'fame', 'w', 'others', 'pic', 'http', 't', 'co', 'klfmiga'], -0.375],
             ['GGs skool has 50 iPads her words - "isn\'t skool amazing" the get to play #chessw/friends in the chess club! #MSA rocks!', datetime.datetime(2011, 9, 9, 0, 32, 21), 41.79600115, -87.60432008, ['ggs', 'skool', 'has', 'ipads', 'her', 'words', 'isn', 't', 'skool', 'amazing', 'the', 'get', 'to', 'play', 'chessw', 'friends', 'in', 'the', 'chess', 'club', 'msa', 'rocks'], 0.25],
             ["I'm at Checkmate Chess Supply (Cary) http://t.co/ZtjuExj", datetime.datetime(2011, 9, 9, 0, 38, 10), 42.228951, -88.246605, ['i', 'm', 'at', 'checkmate', 'chess', 'supply', 'cary', 'http', 't', 'co', 'ztjuexj'], 0.125],
             ['I wonder if this is the kind of chess @neiltyson plays...? #grail #nasatweetup  @ Kennedy Space Center http://t.co/gMGJXgC', datetime.datetime(2011, 9, 9, 1, 14, 58), 28.34326, -80.61127, ['i', 'wonder', 'if', 'this', 'is', 'the', 'kind', 'of', 'chess', 'neiltyson', 'plays', 'grail', 'nasatweetup', 'kennedy', 'space', 'center', 'http', 't', 'co', 'gmgjxgc'], 0.375],
             ['"@babycuzimmanerd: Know when u get that bad feeling in your chest?...Hmmm..." "I gotta pain in my chess an its hard to breav" u all good??', datetime.datetime(2011, 9, 9, 1, 32, 22), 41.53072809, -87.64389299, ['babycuzimmanerd', 'know', 'when', 'u', 'get', 'that', 'bad', 'feeling', 'in', 'your', 'chest', 'hmmm', 'i', 'gotta', 'pain', 'in', 'my', 'chess', 'an', 'its', 'hard', 'to', 'breav', 'u', 'all', 'good'], -0.05357142857142857],
             ['I lived in ur chess game but u changed the rules everyday', datetime.datetime(2011, 9, 9, 4, 29, 38), 31.17176022, -84.73426302, ['i', 'lived', 'in', 'ur', 'chess', 'game', 'but', 'u', 'changed', 'the', 'rules', 'everyday'], -0.16666666666666666],
             ["I'm at Willie Dixon's Blues Heaven Foundation (Historic Site of Chess Records) (2120 S. Michigan Ave., Chicago) http://t.co/euDdzlL", datetime.datetime(2011, 9, 9, 5, 31, 12), 41.853589, -87.624231, ['i', 'm', 'at', 'willie', 'dixon', 's', 'blues', 'heaven', 'foundation', 'historic', 'site', 'of', 'chess', 'records', 's', 'michigan', 'ave', 'chicago', 'http', 't', 'co', 'euddzll'], -0.25],
             ['Chess pieces.   @ J.V. Bailey House http://t.co/pHNGFOE', datetime.datetime(2011, 9, 2, 20, 26, 13), 44.97925186, -93.16854095, ['chess', 'pieces', 'j', 'v', 'bailey', 'house', 'http', 't', 'co', 'phngfoe'], None],
             ['Playin chess to clear the mind', datetime.datetime(2011, 9, 2, 20, 50, 41), 38.9970325, -77.0356301, ['playin', 'chess', 'to', 'clear', 'the', 'mind'], 0.0],
             ['@MrSteveMatchett keep us posted on your chess results.', datetime.datetime(2011, 9, 2, 21, 19, 23), 40.10979198, -76.28119058, ['mrstevematchett', 'keep', 'us', 'posted', 'on', 'your', 'chess', 'results'], None],
             ['#microstock sales nice and steady on @Dreamstime chess players unite for this one! Haha http://t.co/gMzRKjW', datetime.datetime(2011, 9, 2, 21, 44, 12), 33.875078, -118.126954, ['microstock', 'sales', 'nice', 'and', 'steady', 'on', 'dreamstime', 'chess', 'players', 'unite', 'for', 'this', 'one', 'haha', 'http', 't', 'co', 'gmzrkjw'], 0.041666666666666664],
             ['@ZachAllStar chilli chess fries lol', datetime.datetime(2011, 9, 3, 0, 7, 41), 29.6627393, -95.47601923, ['zachallstar', 'chilli', 'chess', 'fries', 'lol'], None],
             ['Tryna make moves like a game of chess.', datetime.datetime(2011, 9, 3, 2, 55, 21), 40.01188117, -75.18427591, ['tryna', 'make', 'moves', 'like', 'a', 'game', 'of', 'chess'], -0.08333333333333333],
             ["Man life is life girl don't play me like chess peices", datetime.datetime(2011, 9, 3, 4, 0, 44), 32.85489302, -96.66359502, ['man', 'life', 'is', 'life', 'girl', 'don', 't', 'play', 'me', 'like', 'chess', 'peices'], -0.25],
             ["1234 5678", datetime.datetime(2011, 9, 3, 4, 0, 45), 33.85489302, -93.66359502, [], None],
             ["cheapjack", datetime.datetime(2011, 9, 3, 4, 0, 46), 33.85489302, -94.66359502, ['cheapjack'], -1.0],
             ["excellent", datetime.datetime(2011, 9, 3, 4, 0, 47), 33.85489302, -95.66359502, ['excellent'], 1.0],
             ["excellent cheapjack", datetime.datetime(2011, 9, 3, 4, 0, 48), 33.85489302, -96.66359502, ['excellent', 'cheapjack'], 0.0],
             ]

word_sentiments = load_sentiments()

tweettext = [('Tweet',args[:4],{'_outputtest':'get_text'},args[0]) for args in tweetlist]
tweettime = [('Tweet',args[:4],{'_outputtest':'get_time'},args[1]) for args in tweetlist]
tweetloc  = [('Tweet',args[:4],{'_outputtest':'get_location'},Position(*args[2:4])) for args in tweetlist]
tweetwords = [('Tweet',args[:4],{'_outputtest':'get_words'},args[4]) for args in tweetlist]
tweetesent = [('Tweet',args[:4],{'_outputtest':'get_sentiment','_outputargs':[{}]},None) for args in tweetlist]
tweetsent = [('Tweet',args[:4],{'_outputtest':'get_sentiment','_outputargs':[word_sentiments]},args[5]) for args in tweetlist]

tweetmult = [(args1[0], (args1[1],args2[1],args3[1],args4[1]), args1[2], [args1[3],args2[3],args3[3],args4[3]])  for args1,args2,args3,args4 in zip(*[it.chain(tweettext,tweettime,tweetloc,tweetwords,tweetesent)]*4)]

def makedict(l):
    return {name:eval(name) for name in l}

tset = makedict(["tweettext","tweettime","tweetloc","tweetwords","tweetsent","tweetesent",
                 ])

jset = makedict(["tweetmult"
                 ])
